guint8 *
purple_ntlm_parse_type2(const gchar *type2, guint32 *flags)
{
	gsize retlen;
	struct type2_message *tmsg;
	static guint8 nonce[8];

	tmsg = (struct type2_message*)purple_base64_decode(type2, &retlen);
	memcpy(nonce, tmsg->nonce, 8);
	if (flags != NULL)
		*flags = GUINT16_FROM_LE(tmsg->flags);
	g_free(tmsg);

	return nonce;
}
